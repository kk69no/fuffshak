<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="FUFFSHAK">
<meta name="theme-color" content="#08060a">
<meta name="mobile-web-app-capable" content="yes">
<title>FUFFSHAK</title>
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon-192.png">
<style>*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}html,body{height:100%;overflow:hidden}body{background:#08060a;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif}#root{height:100%}</style>
</head>
<body>
<div id="root"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<script type="text/babel">
const{useState,useEffect,useCallback,useMemo,useRef}=React;
const uid=()=>Date.now().toString(36)+Math.random().toString(36).substr(2,5);
const fmt=n=>new Intl.NumberFormat("ru-RU").format(n)+" â‚½";
const fmtD=d=>d?new Date(d).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"}):"â€”";
const fmtDT=d=>d?new Date(d).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}):"â€”";
const daysAgo=d=>{if(!d)return 999;return Math.floor((Date.now()-new Date(d).getTime())/864e5)};
const relTime=d=>{if(!d)return"â€”";const m=Math.floor((Date.now()-new Date(d).getTime())/6e4);if(m<1)return"ÑÐµÐ¹Ñ‡Ð°Ñ";if(m<60)return m+"Ð¼";const h=Math.floor(m/60);if(h<24)return h+"Ñ‡";const dd=Math.floor(h/24);if(dd===1)return"Ð²Ñ‡ÐµÑ€Ð°";if(dd<7)return dd+"Ð´";return fmtD(d)};
const SIZES=["XS","S","M","L","XL","XXL","UN"];
const CATS=["ÐŸÐ»Ð°Ñ‚ÑŒÑ","Ð®Ð±ÐºÐ¸","Ð‘Ñ€ÑŽÐºÐ¸","Ð¢Ð¾Ð¿Ñ‹","ÐšÑƒÑ€Ñ‚ÐºÐ¸","ÐšÐ¾ÑÑ‚ÑŽÐ¼Ñ‹","Ð¥ÑƒÐ´Ð¸","ÐÐºÑÐµÑÑÑƒÐ°Ñ€Ñ‹"];
const CC={"ÐŸÐ»Ð°Ñ‚ÑŒÑ":"#e84880","Ð®Ð±ÐºÐ¸":"#a855f7","Ð‘Ñ€ÑŽÐºÐ¸":"#3b82f6","Ð¢Ð¾Ð¿Ñ‹":"#f59e0b","ÐšÑƒÑ€Ñ‚ÐºÐ¸":"#10b981","ÐšÐ¾ÑÑ‚ÑŽÐ¼Ñ‹":"#ec4899","Ð¥ÑƒÐ´Ð¸":"#8b5cf6","ÐÐºÑÐµÑÑÑƒÐ°Ñ€Ñ‹":"#f97316"};
const STATUSES=["ÐÐ¾Ð²Ñ‹Ð¹","Ð¡Ð¾Ð±Ð¸Ñ€Ð°ÐµÑ‚ÑÑ","ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½","Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½","Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‚","ÐžÑ‚Ð¼ÐµÐ½Ñ‘Ð½"];
const DELIVERY=["Ð¡Ð”Ð­Ðš","ÐŸÐ¾Ñ‡Ñ‚Ð°","Boxberry","Ð¡Ð°Ð¼Ð¾Ð²Ñ‹Ð²Ð¾Ð·","ÐšÑƒÑ€ÑŒÐµÑ€"];
const SC={"ÐÐ¾Ð²Ñ‹Ð¹":"#e84880","Ð¡Ð¾Ð±Ð¸Ñ€Ð°ÐµÑ‚ÑÑ":"#f59e0b","ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½":"#a855f7","Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½":"#10b981","Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‚":"#ef4444","ÐžÑ‚Ð¼ÐµÐ½Ñ‘Ð½":"#6b7280"};
const SB={"ÐÐ¾Ð²Ñ‹Ð¹":"rgba(232,72,128,.12)","Ð¡Ð¾Ð±Ð¸Ñ€Ð°ÐµÑ‚ÑÑ":"rgba(245,158,11,.12)","ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½":"rgba(168,85,247,.12)","Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½":"rgba(16,185,129,.12)","Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‚":"rgba(239,68,68,.12)","ÐžÑ‚Ð¼ÐµÐ½Ñ‘Ð½":"rgba(107,114,128,.12)"};
const NS={"ÐÐ¾Ð²Ñ‹Ð¹":"Ð¡Ð¾Ð±Ð¸Ñ€Ð°ÐµÑ‚ÑÑ","Ð¡Ð¾Ð±Ð¸Ñ€Ð°ÐµÑ‚ÑÑ":"ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½","ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½":"Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½"};
const CITIES=["ÐœÐ¾ÑÐºÐ²Ð°","Ð¡ÐŸÐ±","ÐÐ°Ð»ÑŒÑ‡Ð¸Ðº","ÐšÑ€Ð°ÑÐ½Ð¾Ð´Ð°Ñ€","Ð Ð¾ÑÑ‚Ð¾Ð²","ÐšÐ°Ð·Ð°Ð½ÑŒ","ÐœÐ°Ñ…Ð°Ñ‡ÐºÐ°Ð»Ð°","Ð“Ñ€Ð¾Ð·Ð½Ñ‹Ð¹"];
const STEPS=["ÐÐ¾Ð²Ñ‹Ð¹","Ð¡Ð¾Ð±Ð¸Ñ€Ð°ÐµÑ‚ÑÑ","ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½","Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½"];
const ld=(k,fb)=>{try{return JSON.parse(localStorage.getItem("ff5_"+k))||fb}catch{return fb}};
const sv=(k,d)=>{try{localStorage.setItem("ff5_"+k,JSON.stringify(d))}catch{}};
const useP=(k,i)=>{const[v,s]=useState(()=>ld(k,i));useEffect(()=>{sv(k,v)},[k,v]);return[v,s]};
const useToast=()=>{const[t,s]=useState([]);const a=useCallback((m,tp="ok")=>{const i=uid();s(p=>[...p,{id:i,m,type:tp}]);setTimeout(()=>s(p=>p.filter(x=>x.id!==i)),2200)},[]);return{toasts:t,toast:a}};
const deductStock=(p,items)=>{const r=p.map(x=>({...x,sizes:{...x.sizes}}));items.forEach(it=>{const pr=r.find(x=>x.id===it.productId);if(pr&&pr.sizes[it.size]!==undefined)pr.sizes[it.size]=Math.max(0,pr.sizes[it.size]-(+it.qty||1))});return r};
const restoreStock=(p,items)=>{const r=p.map(x=>({...x,sizes:{...x.sizes}}));items.forEach(it=>{const pr=r.find(x=>x.id===it.productId);if(pr&&pr.sizes[it.size]!==undefined)pr.sizes[it.size]+=+it.qty||1});return r};
const checkStock=(p,items)=>{const w=[];items.forEach(it=>{const pr=p.find(x=>x.id===it.productId);if(!pr)return;const a=pr.sizes[it.size];if(a===undefined&&it.size)w.push(`${pr.name}: Ð½ÐµÑ‚ ${it.size}`);else if(a!==undefined&&a<(+it.qty||1))w.push(`${pr.name}(${it.size}): ${a}ÑˆÑ‚`)});return w};
const calcTotal=(items,p,d=0)=>items.reduce((s,it)=>{const pr=p.find(x=>x.id===it.productId);return s+(pr?pr.sellPrice*(+it.qty||1):0)},0)-(+d||0);
const getMsg=(o,p,t)=>{const it=o.items.map(i=>{const pr=p.find(x=>x.id===i.productId);return pr?`${pr.name} (${i.size})`:"?"}).join(", ");return{shipped:`Ð—Ð´Ñ€Ð°Ð²ÑÑ‚Ð²ÑƒÐ¹Ñ‚Ðµ, ${o.clientName}! âœ¨\nÐ’Ð°Ñˆ Ð·Ð°ÐºÐ°Ð· Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½!\nðŸ“¦ ${it}\nðŸšš ${o.deliveryMethod}\nðŸ“ Ð¢Ñ€ÐµÐº: ${o.trackNumber||"â€”"}\nÐ¡Ð¿Ð°ÑÐ¸Ð±Ð¾! ðŸ’•`,ready:`${o.clientName}, Ð·Ð°ÐºÐ°Ð· ÑÐ¾Ð±Ñ€Ð°Ð½! ðŸ“¦\n${it}\nÐ¡ÑƒÐ¼Ð¼Ð°: ${fmt(o.total||0)}`,confirm:`${o.clientName}, Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´Ð°ÐµÑ‚Ðµ?\n${it}\nðŸ’° ${fmt(o.total||0)}\nðŸšš ${o.deliveryMethod}, ${o.clientCity||""}`,delivered:`${o.clientName}, Ð·Ð°ÐºÐ°Ð· Ð´Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½! ðŸŽ‰\nÐ‘ÑƒÐ´ÐµÐ¼ Ñ€Ð°Ð´Ñ‹ Ð¾Ñ‚Ð·Ñ‹Ð²Ñƒ ðŸ’•`}[t]||""};
const cp=(t,toast)=>{navigator.clipboard.writeText(t).then(()=>toast("ðŸ“‹ Ð¡ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾")).catch(()=>{})};
const exportCSV=(orders,products)=>{const rows=["ID;Ð”Ð°Ñ‚Ð°;ÐšÐ»Ð¸ÐµÐ½Ñ‚;Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½;Ð“Ð¾Ñ€Ð¾Ð´;Ð¢Ð¾Ð²Ð°Ñ€Ñ‹;Ð¡ÑƒÐ¼Ð¼Ð°;Ð¡Ñ‚Ð°Ñ‚ÑƒÑ"];orders.forEach(o=>{const it=o.items.map(i=>{const p=products.find(x=>x.id===i.productId);return`${p?p.name:"?"} ${i.size}x${i.qty}`}).join(", ");rows.push([o.id,fmtD(o.createdAt),o.clientName,o.clientPhone||"",o.clientCity||"",`"${it}"`,o.total||0,o.status].join(";"))});const b=new Blob(["\uFEFF"+rows.join("\n")],{type:"text/csv;charset=utf-8"});const u=URL.createObjectURL(b);const a=document.createElement("a");a.href=u;a.download=`fuffshak_${new Date().toISOString().slice(0,10)}.csv`;a.click()};

const css=`
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
:root{--bg:#08060a;--bg2:#0f0c12;--g:rgba(18,14,22,.72);--g2:rgba(24,18,30,.6);--b:rgba(255,255,255,.06);--b2:rgba(255,255,255,.1);--a:#e84880;--a2:#a855f7;--a3:#3b82f6;--gold:#f5c542;--t1:#f4f0f5;--t2:#8a8494;--t3:#4a4554;--r:16px;--r2:12px}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{height:100%;overflow:hidden}
body{background:var(--bg);color:var(--t1);font-family:'Inter',-apple-system,sans-serif;-webkit-font-smoothing:antialiased}
.amb{position:fixed;inset:0;z-index:0;pointer-events:none;background:radial-gradient(ellipse 60% 40% at 30% 0%,rgba(232,72,128,.04) 0%,transparent 60%),radial-gradient(ellipse 50% 30% at 70% 100%,rgba(168,85,247,.03) 0%,transparent 60%),var(--bg)}
.bnav{position:fixed;bottom:0;left:0;right:0;z-index:50;background:rgba(8,6,10,.88);backdrop-filter:blur(24px);-webkit-backdrop-filter:blur(24px);border-top:1px solid var(--b);display:flex;padding:4px 0 env(safe-area-inset-bottom,6px);justify-content:space-around}
.bn{display:flex;flex-direction:column;align-items:center;gap:1px;padding:6px 8px;color:var(--t3);font-size:9px;font-weight:600;letter-spacing:.3px;cursor:pointer;transition:all .2s;border:none;background:none;position:relative;min-width:52px}
.bn.on{color:var(--a)}.bn.on svg{filter:drop-shadow(0 0 8px rgba(232,72,128,.4))}
.bn .dot{position:absolute;top:2px;right:10px;width:7px;height:7px;border-radius:50%;background:var(--a);box-shadow:0 0 6px var(--a);animation:dp 2s infinite}
@keyframes dp{0%,100%{transform:scale(1)}50%{transform:scale(1.3)}}
.main{padding:14px 14px 72px;height:100vh;overflow-y:auto;-webkit-overflow-scrolling:touch;position:relative;z-index:1;scroll-behavior:smooth}.main::-webkit-scrollbar{display:none}
.h1{font-size:26px;font-weight:800;letter-spacing:-.5px;background:linear-gradient(135deg,#fff,rgba(232,72,128,.8));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.h2{font-size:18px;font-weight:700;letter-spacing:-.3px}
.sub{font-size:11px;color:var(--t2);font-weight:500;margin-top:2px}
.gc{background:var(--g);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid var(--b);border-radius:var(--r);padding:16px;margin-bottom:10px;transition:transform .15s;position:relative;overflow:hidden}
.gc:active{transform:scale(.97)}.gc::after{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.08),transparent)}
.bento{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px}.bento .gc{margin-bottom:0}.bento .wide{grid-column:span 2}
.stat-v{font-size:24px;font-weight:800;letter-spacing:-1px;margin:4px 0 2px}
.stat-l{font-size:9px;text-transform:uppercase;letter-spacing:1.2px;color:var(--t2);font-weight:700}
.stat-s{font-size:10px;color:var(--t3);font-weight:500}
.mbar{height:4px;border-radius:2px;background:rgba(255,255,255,.04);margin-top:8px;overflow:hidden}
.mbar-f{height:100%;border-radius:2px;transition:width .6s cubic-bezier(.4,0,.2,1)}
.gsrch{display:flex;align-items:center;gap:8px;background:var(--g);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border:1px solid var(--b);border-radius:28px;padding:11px 16px;margin-bottom:14px;transition:border-color .2s}
.gsrch:focus-within{border-color:rgba(232,72,128,.3);box-shadow:0 0 0 3px rgba(232,72,128,.06)}
.gsrch input{background:none;border:none;outline:none;color:var(--t1);font-size:15px;font-family:'Inter',sans-serif;width:100%;font-weight:500}.gsrch input::placeholder{color:var(--t3)}
.st{display:inline-flex;align-items:center;gap:4px;padding:5px 14px;border-radius:20px;font-size:11px;font-weight:700;cursor:pointer;transition:all .15s;user-select:none;-webkit-user-select:none;letter-spacing:.2px;border:none}.st:active{transform:scale(.9)}
.stepper{display:flex;align-items:center;gap:0;margin:10px 0 6px}
.step{flex:1;height:4px;border-radius:2px;background:rgba(255,255,255,.06);position:relative;transition:background .3s}.step.done{background:var(--a)}.step.active{background:linear-gradient(90deg,var(--a),var(--a2))}.step:not(:last-child){margin-right:3px}
.step-dot{position:absolute;right:-4px;top:-3px;width:10px;height:10px;border-radius:50%;background:var(--a);box-shadow:0 0 8px var(--a);z-index:1}
.ctag{display:inline-flex;align-items:center;padding:2px 10px;border-radius:12px;font-size:10px;font-weight:700;letter-spacing:.3px}
.szchip{display:inline-flex;align-items:center;border-radius:10px;overflow:hidden;border:1px solid var(--b);margin:2px}
.szb{padding:8px 11px;background:rgba(255,255,255,.03);color:var(--t2);border:none;cursor:pointer;font-size:15px;display:flex;align-items:center;transition:all .12s;user-select:none;-webkit-user-select:none}.szb:active{background:var(--a);color:#fff}
.szl{padding:3px 6px;font-size:11px;font-weight:700;color:var(--t2);background:rgba(255,255,255,.02);min-width:28px;text-align:center}.szl.out{opacity:.3;text-decoration:line-through}
.szq{padding:3px 5px;font-size:13px;font-weight:800;color:var(--t1);min-width:24px;text-align:center}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:12px 20px;border-radius:14px;font-size:14px;font-weight:700;cursor:pointer;transition:all .15s;border:none;font-family:'Inter',sans-serif;user-select:none;-webkit-user-select:none;letter-spacing:.2px}.btn:active{transform:scale(.95)}
.bp{background:linear-gradient(135deg,#e84880,#a855f7);color:#fff;box-shadow:0 4px 20px rgba(232,72,128,.3)}
.bg2{background:rgba(255,255,255,.05);color:var(--t1);border:1px solid var(--b)}
.bgh{background:none;color:var(--t2);border:1px solid var(--b)}
.bsm{padding:8px 14px;font-size:12px;border-radius:10px}.bxs{padding:6px 10px;font-size:11px;border-radius:8px}.bfull{width:100%}
.fab{position:fixed;bottom:68px;right:14px;z-index:40;width:54px;height:54px;border-radius:50%;background:linear-gradient(135deg,#e84880,#a855f7);color:#fff;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;box-shadow:0 6px 24px rgba(232,72,128,.35),0 0 40px rgba(168,85,247,.15);transition:all .25s cubic-bezier(.4,0,.2,1)}.fab:active{transform:scale(.85)}
.fab-m{position:fixed;bottom:132px;right:14px;z-index:40;display:flex;flex-direction:column;gap:8px}
.fab-o{padding:12px 18px;background:var(--g);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid var(--b2);border-radius:14px;color:var(--t1);font-size:14px;font-weight:600;cursor:pointer;box-shadow:0 8px 32px rgba(0,0,0,.5);white-space:nowrap;transition:all .15s;display:flex;align-items:center;gap:8px}.fab-o:active{transform:scale(.95);background:rgba(232,72,128,.15)}
.fov{position:fixed;inset:0;z-index:35;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px)}
@keyframes fi{from{opacity:0;transform:translateY(12px) scale(.9)}to{opacity:1;transform:translateY(0) scale(1)}}
.fab-m>div{animation:fi .2s backwards}.fab-m>div:nth-child(2){animation-delay:.06s}
.mo{position:fixed;inset:0;z-index:100;background:var(--bg);overflow-y:auto;-webkit-overflow-scrolling:touch;animation:mi .25s}.mo::-webkit-scrollbar{display:none}
@keyframes mi{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
.mo-h{display:flex;align-items:center;gap:10px;padding:12px 14px;border-bottom:1px solid var(--b);position:sticky;top:0;background:rgba(8,6,10,.9);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);z-index:5}
.mo-t{font-size:17px;font-weight:700;flex:1;letter-spacing:-.3px}.mo-b{padding:16px 14px}
.mo-f{padding:12px 14px 24px;position:sticky;bottom:0;background:rgba(8,6,10,.92);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border-top:1px solid var(--b);display:flex;gap:8px}
.fg{margin-bottom:14px}
.fl{display:block;font-size:10px;text-transform:uppercase;letter-spacing:1.2px;color:var(--t3);margin-bottom:5px;font-weight:700}
.fi{width:100%;background:rgba(255,255,255,.04);border:1px solid var(--b);border-radius:var(--r2);padding:13px 14px;color:var(--t1);font-size:15px;font-family:'Inter',sans-serif;outline:none;transition:all .2s;-webkit-appearance:none}
.fi:focus{border-color:rgba(232,72,128,.4);box-shadow:0 0 0 3px rgba(232,72,128,.08);background:rgba(255,255,255,.06)}.fi::placeholder{color:var(--t3)}
.fr{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.chips{display:flex;gap:6px;flex-wrap:wrap}
.chip{padding:9px 16px;border-radius:12px;border:1px solid var(--b);background:rgba(255,255,255,.03);color:var(--t2);font-size:13px;font-weight:600;cursor:pointer;transition:all .15s;user-select:none;-webkit-user-select:none}
.chip.on{background:linear-gradient(135deg,rgba(232,72,128,.2),rgba(168,85,247,.15));border-color:rgba(232,72,128,.3);color:var(--t1)}.chip:active:not(.on){background:rgba(255,255,255,.06)}
.cpills{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px}
.cpill{padding:7px 16px;border-radius:20px;border:1px solid var(--b);background:none;color:var(--t2);font-size:12px;font-weight:600;cursor:pointer;transition:all .15s;user-select:none;-webkit-user-select:none}
.cpill:active,.cpill.on{background:linear-gradient(135deg,var(--a),var(--a2));border-color:transparent;color:#fff}
.msgt{background:rgba(255,255,255,.03);border:1px solid var(--b);border-radius:var(--r2);padding:12px;font-size:12px;color:var(--t2);white-space:pre-wrap;line-height:1.6;margin-top:8px;position:relative}
.msgc{position:absolute;top:8px;right:8px;padding:7px 14px;border-radius:10px;background:linear-gradient(135deg,var(--a),var(--a2));color:#fff;border:none;font-size:11px;font-weight:700;cursor:pointer}
.tl{border-left:2px solid var(--b);margin:8px 0 8px 6px;padding-left:14px}
.tle{padding:4px 0;font-size:11px;color:var(--t2);display:flex;align-items:center;gap:6px;position:relative}
.tle::before{content:'';position:absolute;left:-19px;width:8px;height:8px;border-radius:50%;border:2px solid var(--a);background:var(--bg)}
.feed-i{display:flex;gap:10px;padding:10px 0;border-bottom:1px solid var(--b);align-items:flex-start}
.feed-dot{width:8px;height:8px;border-radius:50%;margin-top:5px;flex-shrink:0}
.feed-txt{flex:1;font-size:12px;color:var(--t2);line-height:1.4}.feed-txt b{color:var(--t1);font-weight:600}
.feed-time{font-size:10px;color:var(--t3);white-space:nowrap;margin-top:2px}
.tc{position:fixed;bottom:68px;left:50%;transform:translateX(-50%);z-index:200;display:flex;flex-direction:column;gap:5px;align-items:center;pointer-events:none}
@keyframes ti{from{opacity:0;transform:translateY(8px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}
.to{background:var(--g);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid var(--b2);border-radius:16px;padding:10px 22px;color:var(--t1);font-size:13px;font-weight:600;box-shadow:0 8px 32px rgba(0,0,0,.4);animation:ti .2s;white-space:nowrap}.to.err{border-color:rgba(239,68,68,.3);color:#ef4444}
.wbox{background:rgba(239,68,68,.06);border:1px solid rgba(239,68,68,.15);border-radius:var(--r2);padding:10px 14px;margin-bottom:10px;font-size:12px;color:#ef4444;display:flex;align-items:center;gap:6px;font-weight:500}
.badge-t{display:inline-flex;align-items:center;gap:3px;padding:2px 8px;border-radius:8px;font-size:9px;font-weight:800;background:linear-gradient(135deg,rgba(245,197,66,.15),rgba(245,197,66,.05));color:#f5c542;border:1px solid rgba(245,197,66,.2);letter-spacing:.3px}
.badge-n{display:inline-flex;padding:2px 8px;border-radius:8px;font-size:9px;font-weight:800;background:rgba(232,72,128,.12);color:var(--a);letter-spacing:.3px}
.ud{display:inline-block;width:7px;height:7px;border-radius:50%;background:var(--a);margin-left:4px;animation:up 1.5s infinite}
@keyframes up{0%,100%{box-shadow:0 0 0 0 rgba(232,72,128,.4)}50%{box-shadow:0 0 0 4px rgba(232,72,128,0)}}
.stale-b{position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,#ef4444,transparent);border-radius:var(--r) var(--r) 0 0}
.divider{border-top:1px solid var(--b);margin:12px 0}
.empty{text-align:center;padding:40px 14px;color:var(--t3);font-size:13px;font-weight:500}
.csug{position:absolute;top:100%;left:0;right:0;background:var(--g);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid var(--b);border-radius:0 0 var(--r2) var(--r2);z-index:20;overflow:hidden}
.csug-i{padding:11px 14px;cursor:pointer;border-bottom:1px solid var(--b);font-size:13px;font-weight:500;transition:background .1s}.csug-i:active{background:rgba(232,72,128,.1)}
.tabs{display:flex;gap:4px;overflow-x:auto;padding:2px 0 10px;scrollbar-width:none}.tabs::-webkit-scrollbar{display:none}
.tab{padding:8px 16px;border-radius:12px;background:rgba(255,255,255,.03);border:1px solid var(--b);color:var(--t3);font-size:12px;font-weight:700;white-space:nowrap;cursor:pointer;transition:all .15s;flex-shrink:0}
.tab.on{background:linear-gradient(135deg,rgba(232,72,128,.15),rgba(168,85,247,.1));border-color:rgba(232,72,128,.2);color:var(--t1)}
.hscr{display:flex;gap:8px;overflow-x:auto;padding:2px 0 10px;scrollbar-width:none;scroll-snap-type:x mandatory}.hscr::-webkit-scrollbar{display:none}.hscr>.gc{min-width:140px;flex-shrink:0;scroll-snap-align:start;margin-bottom:0}
.cn{font-weight:700;font-size:14px;color:var(--t1);letter-spacing:-.2px}
.cp{font-weight:800;font-size:15px;background:linear-gradient(135deg,#f5c542,#f59e0b);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.crow{display:flex;align-items:center;justify-content:space-between;gap:8px}
`;

const ic=(d,w=22,s=2)=>React.createElement("svg",{width:w,height:w,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:s,strokeLinecap:"round",strokeLinejoin:"round"},d);
const I={
home:ic([React.createElement("path",{key:0,d:"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"}),React.createElement("polyline",{key:1,points:"9 22 9 12 15 12 15 22"})]),
tag:ic([React.createElement("path",{key:0,d:"M20.59 13.41l-7.17 7.17a2 2 0 01-2.83 0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"}),React.createElement("line",{key:1,x1:7,y1:7,x2:7.01,y2:7})]),
box:ic([React.createElement("path",{key:0,d:"M21 10V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16v-2"}),React.createElement("polyline",{key:1,points:"3.27 6.96 12 12.01 20.73 6.96"}),React.createElement("line",{key:2,x1:12,y1:22.08,x2:12,y2:12})]),
usr:ic([React.createElement("path",{key:0,d:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),React.createElement("circle",{key:1,cx:9,cy:7,r:4})]),
dol:ic([React.createElement("line",{key:0,x1:12,y1:1,x2:12,y2:23}),React.createElement("path",{key:1,d:"M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"})]),
plus:ic([React.createElement("line",{key:0,x1:12,y1:5,x2:12,y2:19}),React.createElement("line",{key:1,x1:5,y1:12,x2:19,y2:12})],24,2.5),
back:ic([React.createElement("polyline",{key:0,points:"15 18 9 12 15 6"})]),
chk:ic([React.createElement("polyline",{key:0,points:"20 6 9 17 4 12"})],16,2.5),
srch:ic([React.createElement("circle",{key:0,cx:11,cy:11,r:8}),React.createElement("line",{key:1,x1:21,y1:21,x2:16.65,y2:16.65})],18),
nxt:ic([React.createElement("polyline",{key:0,points:"9 18 15 12 9 6"})],12,2.5),
del:ic([React.createElement("polyline",{key:0,points:"3 6 5 6 21 6"}),React.createElement("path",{key:1,d:"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})],16),
ed:ic([React.createElement("path",{key:0,d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),React.createElement("path",{key:1,d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})],16),
copy:ic([React.createElement("rect",{key:0,x:9,y:9,width:13,height:13,rx:2}),React.createElement("path",{key:1,d:"M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"})],16),
msg:ic([React.createElement("path",{key:0,d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})],16),
dl:ic([React.createElement("path",{key:0,d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"}),React.createElement("polyline",{key:1,points:"7 10 12 15 17 10"}),React.createElement("line",{key:2,x1:12,y1:15,x2:12,y2:3})],16),
fire:ic([React.createElement("path",{key:0,d:"M12 2c0 4-4 6-4 10a4 4 0 108 0c0-4-4-6-4-10z"})],14),
minus:ic([React.createElement("line",{key:0,x1:5,y1:12,x2:19,y2:12})],16,2.5),
pls:ic([React.createElement("line",{key:0,x1:12,y1:5,x2:12,y2:19}),React.createElement("line",{key:1,x1:5,y1:12,x2:19,y2:12})],16,2.5),
star:ic([React.createElement("polygon",{key:0,points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})],12),
warn:ic([React.createElement("path",{key:0,d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"}),React.createElement("line",{key:1,x1:12,y1:9,x2:12,y2:13}),React.createElement("line",{key:2,x1:12,y1:17,x2:12.01,y2:17})],14),
};

const h=React.createElement;
function StBadge({status,onClick}){return h("span",{className:"st",style:{color:SC[status],background:SB[status]},onClick},status,NS[status]&&h("span",{style:{marginLeft:2}},I.nxt))}
function Stepper({status}){const i=STEPS.indexOf(status);return h("div",{className:"stepper"},STEPS.map((s,j)=>h("div",{key:s,className:`step ${j<i?"done":""} ${j===i?"active":""}`,style:j===i?{background:`linear-gradient(90deg,${SC[s]||"var(--a)"},transparent)`}:j<i?{background:SC[s]||"var(--a)"}:{}},j===i&&h("div",{className:"step-dot",style:{background:SC[s],boxShadow:`0 0 8px ${SC[s]}`}}))))}
function CTag({cat}){const c=CC[cat]||"var(--a)";return h("span",{className:"ctag",style:{background:c+"18",color:c}},cat)}
function SzChips({sizes,onChange}){return h("div",{style:{display:"flex",flexWrap:"wrap",gap:3}},Object.entries(sizes).map(([s,q])=>h("div",{key:s,className:"szchip"},h("button",{className:"szb",onClick:()=>onChange(s,Math.max(0,q-1))},I.minus),h("div",{className:`szl ${q===0?"out":""}`},s),h("div",{className:"szq"},q),h("button",{className:"szb",onClick:()=>onChange(s,q+1)},I.pls))))}

function AddProdModal({onSave,onClose}){const[n,sN]=useState("");const[p,sP]=useState("");const[c,sC]=useState("");const[cat,sCat]=useState(CATS[0]);const[sz,sSz]=useState({S:1,M:1,L:1});
const tog=s=>sSz(v=>{const x={...v};if(x[s]!==undefined)delete x[s];else x[s]=1;return x});
const save=()=>{if(!n||!p)return;onSave({id:uid(),name:n,sellPrice:+p,costPrice:+(c||0),category:cat,sizes:{...sz},sku:"",minStock:2,description:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})};
return h("div",{className:"mo"},h("div",{className:"mo-h"},h("button",{className:"btn bgh bsm",onClick:onClose},I.back),h("div",{className:"mo-t"},"ÐÐ¾Ð²Ñ‹Ð¹ Ñ‚Ð¾Ð²Ð°Ñ€")),
h("div",{className:"mo-b"},h("div",{className:"fg"},h("label",{className:"fl"},"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ"),h("input",{className:"fi",value:n,onChange:e=>sN(e.target.value),placeholder:"ÐŸÐ»Ð°Ñ‚ÑŒÐµ Ð¼Ð°ÐºÑÐ¸",autoFocus:true})),
h("div",{className:"fr"},h("div",{className:"fg"},h("label",{className:"fl"},"Ð¦ÐµÐ½Ð°"),h("input",{className:"fi",type:"number",value:p,onChange:e=>sP(e.target.value),placeholder:"0"})),h("div",{className:"fg"},h("label",{className:"fl"},"Ð¡ÐµÐ±ÐµÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ"),h("input",{className:"fi",type:"number",value:c,onChange:e=>sC(e.target.value),placeholder:"0"}))),
h("div",{className:"fg"},h("label",{className:"fl"},"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"),h("div",{className:"chips"},CATS.map(x=>h("div",{key:x,className:`chip ${cat===x?"on":""}`,onClick:()=>sCat(x)},x)))),
h("div",{className:"fg"},h("label",{className:"fl"},"Ð Ð°Ð·Ð¼ÐµÑ€Ñ‹"),h("div",{className:"chips"},SIZES.map(s=>h("div",{key:s,className:`chip ${sz[s]!==undefined?"on":""}`,onClick:()=>tog(s)},s))))),
h("div",{className:"mo-f"},h("button",{className:"btn bp bfull",onClick:save},I.chk," Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ")))}

function AddOrdModal({products,clients,onSave,onClose,toast}){const[nm,sNm]=useState("");const[ph,sPh]=useState("");const[city,sCity]=useState("");const[del,sDel]=useState("Ð¡Ð”Ð­Ðš");
const[items,sItems]=useState([{productId:"",size:"",qty:1}]);const[urg,sUrg]=useState(false);const[sug,sSug]=useState([]);
useEffect(()=>{if(nm.length<2){sSug([]);return}sSug(clients.filter(c=>c.name.toLowerCase().includes(nm.toLowerCase())).slice(0,3))},[nm,clients]);
const pickC=cl=>{sNm(cl.name);sPh(cl.phone||"");sCity(cl.city||"");sSug([])};
const sI=(i,k,v)=>{const it=[...items];it[i]={...it[i],[k]:v};if(k==="productId")it[i].size="";sItems(it)};
const total=calcTotal(items,products);const warns=useMemo(()=>checkStock(products,items.filter(it=>it.productId&&it.size)),[products,items]);
const save=()=>{if(!nm||!items[0].productId)return;if(warns.length>0){toast("â›” "+warns[0],"err");return}
const fi=items.map(it=>{if(it.productId&&!it.size){const pr=products.find(x=>x.id===it.productId);if(pr){const a=Object.entries(pr.sizes).find(([,q])=>q>0);if(a)return{...it,size:a[0]}}}return it}).filter(it=>it.productId);
onSave({id:uid(),clientName:nm,clientPhone:ph,clientCity:city,clientAddress:"",deliveryMethod:del,trackNumber:"",status:"ÐÐ¾Ð²Ñ‹Ð¹",urgent:urg,items:fi,discount:0,notes:"",prepaid:false,total,history:[{status:"ÐÐ¾Ð²Ñ‹Ð¹",date:new Date().toISOString()}],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})};
return h("div",{className:"mo"},h("div",{className:"mo-h"},h("button",{className:"btn bgh bsm",onClick:onClose},I.back),h("div",{className:"mo-t"},"ÐÐ¾Ð²Ñ‹Ð¹ Ð·Ð°ÐºÐ°Ð·"),total>0&&h("span",{className:"cp"},fmt(total))),
h("div",{className:"mo-b"},h("div",{className:"fg",style:{position:"relative"}},h("label",{className:"fl"},"ÐšÐ»Ð¸ÐµÐ½Ñ‚"),h("input",{className:"fi",value:nm,onChange:e=>sNm(e.target.value),placeholder:"Ð˜Ð¼Ñ"}),sug.length>0&&h("div",{className:"csug"},sug.map(c=>h("div",{key:c.id,className:"csug-i",onClick:()=>pickC(c)},h("b",null,c.name)," ",h("span",{style:{color:"var(--t3)"}},c.phone," Â· ",c.city))))),
h("div",{className:"fr"},h("div",{className:"fg"},h("label",{className:"fl"},"Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½"),h("input",{className:"fi",value:ph,onChange:e=>sPh(e.target.value),placeholder:"+7..."})),h("div",{className:"fg"},h("label",{className:"fl"},"Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ°"),h("select",{className:"fi",value:del,onChange:e=>sDel(e.target.value)},DELIVERY.map(d=>h("option",{key:d},d))))),
h("div",{className:"fg"},h("label",{className:"fl"},"Ð“Ð¾Ñ€Ð¾Ð´"),h("div",{className:"cpills"},CITIES.map(c=>h("div",{key:c,className:`cpill ${city===c?"on":""}`,onClick:()=>sCity(city===c?"":c)},c)))),
h("div",{className:"divider"}),h("label",{className:"fl"},"Ð¢Ð¾Ð²Ð°Ñ€Ñ‹"),
items.map((it,i)=>{const pr=products.find(x=>x.id===it.productId);return h("div",{key:i,style:{marginBottom:10}},h("select",{className:"fi",value:it.productId,onChange:e=>sI(i,"productId",e.target.value),style:{marginBottom:6}},h("option",{value:""},"â€” Ð¢Ð¾Ð²Ð°Ñ€ â€”"),products.map(p=>{const t=Object.values(p.sizes).reduce((a,b)=>a+b,0);return h("option",{key:p.id,value:p.id,disabled:t===0},p.name," Â· ",fmt(p.sellPrice),t===0?" (Ð½ÐµÑ‚)":"")})),
pr&&h("div",{className:"chips"},Object.entries(pr.sizes).map(([s,q])=>h("div",{key:s,className:`chip ${it.size===s?"on":""}`,onClick:()=>q>0&&sI(i,"size",s),style:q<=0?{opacity:.3}:{}},s," ",h("span",{style:{fontSize:10,opacity:.5}},"(",q,")")))),items.length>1&&h("button",{className:"btn bgh bxs",onClick:()=>sItems(p=>p.filter((_,j)=>j!==i)),style:{marginTop:6,color:"#ef4444"}},I.del," Ð£Ð±Ñ€Ð°Ñ‚ÑŒ"))}),
h("button",{className:"btn bg2 bsm",onClick:()=>sItems(p=>[...p,{productId:"",size:"",qty:1}])},I.pls," Ð•Ñ‰Ñ‘ Ñ‚Ð¾Ð²Ð°Ñ€"),
warns.length>0&&h("div",{className:"wbox"},I.warn," ",warns[0]),h("div",{className:"divider"}),
h("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer",fontSize:13,fontWeight:600,color:urg?"var(--a)":"var(--t2)",padding:"6px 0"}},h("input",{type:"checkbox",checked:urg,onChange:e=>sUrg(e.target.checked),style:{accentColor:"var(--a)",width:18,height:18}}),I.fire," Ð¡Ñ€Ð¾Ñ‡Ð½Ñ‹Ð¹ Ð·Ð°ÐºÐ°Ð·")),
h("div",{className:"mo-f"},h("button",{className:"btn bp bfull",onClick:save},I.chk," Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð·Ð°ÐºÐ°Ð·")))}

function ViewOrdModal({order,products,onSave,onClose,toast}){const[f,sF]=useState({...order,items:order.items.map(x=>({...x}))});const[ed,sEd]=useState(false);const[mt,sMt]=useState(null);
const set=(k,v)=>sF(p=>({...p,[k]:v}));const total=calcTotal(f.items,products,f.discount);const hist=f.history||[];const msg=mt?getMsg({...f,total},products,mt):"";
const save=()=>{onSave({...f,total,discount:+f.discount||0,updatedAt:new Date().toISOString()})};
const nxt=()=>{const ns=NS[f.status];if(ns)sF(p=>({...p,status:ns,history:[...(p.history||[]),{status:ns,date:new Date().toISOString()}]}))};
return h("div",{className:"mo"},h("div",{className:"mo-h"},h("button",{className:"btn bgh bsm",onClick:onClose},I.back),h("div",{className:"mo-t"},"Ð—Ð°ÐºÐ°Ð·"),h(StBadge,{status:f.status,onClick:nxt})),
h("div",{className:"mo-b"},!ed?h(React.Fragment,null,
h(Stepper,{status:f.status}),
h("div",{style:{fontSize:20,fontWeight:800,marginBottom:3,letterSpacing:-.5}},f.clientName,f.urgent&&h("span",{className:"ud"})),
h("div",{style:{fontSize:13,color:"var(--t2)",marginBottom:2,fontWeight:500}},f.clientPhone||"â€”"),
h("div",{style:{fontSize:13,color:"var(--t2)",marginBottom:10,fontWeight:500}},"ðŸ“ ",f.clientCity||"â€”"," Â· ",f.deliveryMethod),
f.trackNumber&&h("div",{className:"gc",style:{display:"flex",alignItems:"center",gap:8,marginBottom:10,padding:12}},h("span",{style:{fontSize:11,color:"var(--t3)",fontWeight:600}},"Ð¢Ð Ð•Ðš"),h("span",{style:{fontFamily:"monospace",fontSize:15,color:"var(--t1)",fontWeight:700,flex:1}},f.trackNumber),h("button",{className:"btn bp bxs",onClick:()=>cp(f.trackNumber,toast)},I.copy," ÐšÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ")),
h("div",{className:"divider"}),
f.items.map((it,i)=>{const p=products.find(x=>x.id===it.productId);return h("div",{key:i,style:{display:"flex",justifyContent:"space-between",padding:"6px 0",alignItems:"center"}},h("div",null,h("span",{style:{fontWeight:600}},p?p.name:"?"),h(CTag,{cat:p?p.category:""}),h("span",{style:{marginLeft:4,fontSize:11,color:"var(--t3)"}},it.size," Ã—",it.qty)),h("span",{className:"cp",style:{fontSize:13}},p?fmt(p.sellPrice*(+it.qty||1)):""))}),
h("div",{className:"divider"}),
h("div",{className:"crow"},h("span",{style:{fontSize:12,color:"var(--t2)",fontWeight:500}},f.discount?`Ð¡ÐºÐ¸Ð´ÐºÐ°: ${fmt(f.discount)} `:"",f.prepaid?"âœ“ ÐžÐ¿Ð»Ð°Ñ‡ÐµÐ½":""),h("span",{style:{fontSize:24,fontWeight:900,background:"linear-gradient(135deg,var(--gold),#f59e0b)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}},fmt(total))),
f.notes&&h("div",{style:{marginTop:8,fontSize:12,color:"var(--t2)",background:"rgba(255,255,255,.03)",padding:"10px 12px",borderRadius:12,fontWeight:500}},"ðŸ’¬ ",f.notes),
h("div",{className:"divider"}),h("label",{className:"fl"},"Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ñƒ"),
h("div",{style:{display:"flex",gap:5,flexWrap:"wrap",marginBottom:6}},[["confirm","ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð´Ð¸Ñ‚ÑŒ"],["ready","Ð¡Ð¾Ð±Ñ€Ð°Ð½"],["shipped","ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½"],["delivered","Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½"]].map(([k,l])=>h("button",{key:k,className:`btn ${mt===k?"bp":"bg2"} bxs`,onClick:()=>sMt(mt===k?null:k)},I.msg," ",l))),
msg&&h("div",{className:"msgt"},msg,h("button",{className:"msgc",onClick:()=>cp(msg,toast)},"ÐšÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ")),
hist.length>0&&h(React.Fragment,null,h("div",{className:"divider"}),h("label",{className:"fl"},"Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ"),h("div",{className:"tl"},hist.map((x,i)=>h("div",{key:i,className:"tle"},h("span",{style:{color:SC[x.status],fontWeight:700}},x.status),h("span",{style:{color:"var(--t3)"}},relTime(x.date))))))
):h(React.Fragment,null,
h("div",{className:"fg"},h("label",{className:"fl"},"Ð˜Ð¼Ñ"),h("input",{className:"fi",value:f.clientName,onChange:e=>set("clientName",e.target.value)})),
h("div",{className:"fr"},h("div",{className:"fg"},h("label",{className:"fl"},"Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½"),h("input",{className:"fi",value:f.clientPhone||"",onChange:e=>set("clientPhone",e.target.value)})),h("div",{className:"fg"},h("label",{className:"fl"},"Ð“Ð¾Ñ€Ð¾Ð´"),h("input",{className:"fi",value:f.clientCity||"",onChange:e=>set("clientCity",e.target.value)}))),
h("div",{className:"fg"},h("label",{className:"fl"},"ÐÐ´Ñ€ÐµÑ"),h("input",{className:"fi",value:f.clientAddress||"",onChange:e=>set("clientAddress",e.target.value)})),
h("div",{className:"fr"},h("div",{className:"fg"},h("label",{className:"fl"},"Ð¢Ñ€ÐµÐº"),h("input",{className:"fi",value:f.trackNumber||"",onChange:e=>set("trackNumber",e.target.value)})),h("div",{className:"fg"},h("label",{className:"fl"},"Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ°"),h("select",{className:"fi",value:f.deliveryMethod,onChange:e=>set("deliveryMethod",e.target.value)},DELIVERY.map(d=>h("option",{key:d},d))))),
h("div",{className:"fr"},h("div",{className:"fg"},h("label",{className:"fl"},"Ð¡ÐºÐ¸Ð´ÐºÐ°"),h("input",{className:"fi",type:"number",value:f.discount||0,onChange:e=>set("discount",e.target.value)})),h("div",{className:"fg"},h("label",{className:"fl"},"Ð¡Ñ‚Ð°Ñ‚ÑƒÑ"),h("select",{className:"fi",value:f.status,onChange:e=>set("status",e.target.value)},STATUSES.map(s=>h("option",{key:s},s))))),
h("div",{style:{display:"flex",gap:14,padding:"6px 0"}},h("label",{style:{display:"flex",alignItems:"center",gap:5,fontSize:13,fontWeight:600,color:"var(--t2)"}},h("input",{type:"checkbox",checked:f.prepaid||false,onChange:e=>set("prepaid",e.target.checked),style:{accentColor:"var(--a)",width:16,height:16}}),"ÐžÐ¿Ð»Ð°Ñ‡ÐµÐ½"),
h("label",{style:{display:"flex",alignItems:"center",gap:5,fontSize:13,fontWeight:600,color:f.urgent?"var(--a)":"var(--t2)"}},h("input",{type:"checkbox",checked:f.urgent||false,onChange:e=>set("urgent",e.target.checked),style:{accentColor:"var(--a)",width:16,height:16}}),I.fire," Ð¡Ñ€Ð¾Ñ‡Ð½Ñ‹Ð¹")),
h("div",{className:"fg"},h("label",{className:"fl"},"Ð—Ð°Ð¼ÐµÑ‚ÐºÐ¸"),h("textarea",{className:"fi",value:f.notes||"",onChange:e=>set("notes",e.target.value),style:{resize:"vertical",minHeight:50}})))),
h("div",{className:"mo-f"},!ed?h(React.Fragment,null,h("button",{className:"btn bg2 bfull",onClick:()=>sEd(true)},I.ed," Ð ÐµÐ´."),h("button",{className:"btn bp bfull",onClick:save},I.chk," Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ")):h(React.Fragment,null,h("button",{className:"btn bgh bfull",onClick:()=>sEd(false)},"ÐÐ°Ð·Ð°Ð´"),h("button",{className:"btn bp bfull",onClick:()=>{save();sEd(false)}},I.chk," Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ"))))}

function HomePage({products,orders}){const stock=products.reduce((s,p)=>s+Object.values(p.sizes).reduce((a,b)=>a+b,0),0);const act=orders.filter(o=>["ÐÐ¾Ð²Ñ‹Ð¹","Ð¡Ð¾Ð±Ð¸Ñ€Ð°ÐµÑ‚ÑÑ","ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½"].includes(o.status));const done=orders.filter(o=>o.status==="Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½");const rev=done.reduce((s,o)=>s+(o.total||0),0);const cost=done.reduce((s,o)=>s+o.items.reduce((is,it)=>{const p=products.find(x=>x.id===it.productId);return is+(p?p.costPrice*(+it.qty||1):0)},0),0);const profit=rev-cost;const newO=orders.filter(o=>o.status==="ÐÐ¾Ð²Ñ‹Ð¹").length;const stale=orders.filter(o=>o.status==="ÐÐ¾Ð²Ñ‹Ð¹"&&daysAgo(o.createdAt)>=2);const low=products.filter(p=>{const t=Object.values(p.sizes).reduce((a,b)=>a+b,0);return t>0&&t<=p.minStock});const out=products.filter(p=>Object.keys(p.sizes).length>0&&Object.values(p.sizes).reduce((a,b)=>a+b,0)===0);
const feed=[];orders.forEach(o=>{(o.history||[]).forEach(x=>{feed.push({type:x.status,name:o.clientName,date:x.date,color:SC[x.status]})})});feed.sort((a,b)=>new Date(b.date)-new Date(a.date));
return h("div",null,h("div",{className:"h1"},"FUFFSHAK"),h("div",{className:"sub",style:{marginBottom:14}},new Date().toLocaleDateString("ru-RU",{weekday:"long",day:"numeric",month:"long"})),
h("div",{className:"bento"},h("div",{className:"gc"},h("div",{className:"stat-l"},"Ð¡ÐšÐ›ÐÐ”"),h("div",{className:"stat-v"},stock),h("div",{className:"stat-s"},products.length," Ð½Ð°Ð¸Ð¼."),h("div",{className:"mbar"},h("div",{className:"mbar-f",style:{width:Math.min(100,stock/2)+"%",background:"linear-gradient(90deg,var(--a),var(--a2))"}}))),
h("div",{className:"gc"},h("div",{className:"stat-l"},"Ð—ÐÐšÐÐ—Ð«"),h("div",{className:"stat-v"},act.length),newO>0&&h("div",{className:"badge-n",style:{marginTop:4}},"ðŸ”´ ",newO," Ð½Ð¾Ð²Ñ‹Ñ…")),
h("div",{className:"gc"},h("div",{className:"stat-l"},"Ð’Ð«Ð Ð£Ð§ÐšÐ"),h("div",{className:"stat-v",style:{fontSize:18}},fmt(rev)),h("div",{className:"mbar"},h("div",{className:"mbar-f",style:{width:rev>0?"70%":"0%",background:"linear-gradient(90deg,var(--gold),#f59e0b)"}}))),
h("div",{className:"gc"},h("div",{className:"stat-l"},"ÐŸÐ Ð˜Ð‘Ð«Ð›Ð¬"),h("div",{className:"stat-v",style:{fontSize:18,color:profit>=0?"#10b981":"#ef4444"}},fmt(profit)),rev>0&&h("div",{className:"stat-s"},"ÐœÐ°Ñ€Ð¶Ð° ",Math.round(profit/rev*100),"%")),
h("div",{className:"gc wide"},h("div",{className:"crow"},h("div",null,h("div",{className:"stat-l"},"Ð¡Ð Ð•Ð”ÐÐ˜Ð™ Ð§Ð•Ðš"),h("div",{className:"stat-v",style:{fontSize:20}},done.length?fmt(Math.round(rev/done.length)):"â€”")),h("div",{style:{textAlign:"right"}},h("div",{className:"stat-l"},"Ð”ÐžÐ¡Ð¢ÐÐ’Ð›Ð•ÐÐž"),h("div",{className:"stat-v",style:{fontSize:20}},done.length))))),
stale.length>0&&h("div",{className:"wbox"},I.warn," ",stale.length," Ð·Ð°ÐºÐ°Ð·(Ð¾Ð²) Ð¶Ð´ÑƒÑ‚ >2 Ð´Ð½ÐµÐ¹"),
(low.length>0||out.length>0)&&h("div",{className:"gc",style:{marginBottom:14}},out.map(p=>h("div",{key:p.id,style:{fontSize:12,padding:"2px 0",fontWeight:500}},h("span",{style:{color:"#ef4444"}},"â›” "),p.name)),low.map(p=>h("div",{key:p.id,style:{fontSize:12,padding:"2px 0",fontWeight:500}},h("span",{style:{color:"#f59e0b"}},"âš  "),p.name," (",Object.values(p.sizes).reduce((a,b)=>a+b,0),")"))),
feed.length>0&&h(React.Fragment,null,h("div",{className:"h2",style:{marginBottom:8}},"Ð›ÐµÐ½Ñ‚Ð°"),h("div",{className:"gc"},feed.slice(0,8).map((f,i)=>h("div",{key:i,className:"feed-i"},h("div",{className:"feed-dot",style:{background:f.color}}),h("div",{className:"feed-txt"},h("b",null,f.name)," â†’ ",f.type),h("div",{className:"feed-time"},relTime(f.date)))))))}

function ProductsPage({products,setProducts,toast}){const[search,sSearch]=useState("");
const list=useMemo(()=>{let l=[...products];if(search)l=l.filter(p=>p.name.toLowerCase().includes(search.toLowerCase()));return l},[products,search]);
const chgSz=(pid,sz,val)=>{setProducts(prev=>prev.map(p=>p.id===pid?{...p,sizes:{...p.sizes,[sz]:val},updatedAt:new Date().toISOString()}:p))};
const del=pid=>{setProducts(prev=>prev.filter(x=>x.id!==pid));toast("Ð£Ð´Ð°Ð»Ñ‘Ð½")};
return h("div",null,h("div",{className:"h1"},"Ð¢Ð¾Ð²Ð°Ñ€Ñ‹"),h("div",{className:"sub",style:{marginBottom:14}},products.length," Ð½Ð°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ð¹"),
h("div",{className:"gsrch"},I.srch,h("input",{placeholder:"ÐŸÐ¾Ð¸ÑÐº...",value:search,onChange:e=>sSearch(e.target.value)})),
list.length===0?h("div",{className:"empty"},"ÐÐµÑ‚ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²"):list.map(p=>{const tot=Object.values(p.sizes).reduce((a,b)=>a+b,0);const isLow=tot>0&&tot<=p.minStock;const isOut=tot===0&&Object.keys(p.sizes).length>0;
return h("div",{key:p.id,className:"gc"},h("div",{className:"crow"},h("div",{style:{display:"flex",alignItems:"center",gap:6}},h("span",{className:"cn"},p.name),h(CTag,{cat:p.category})),h("span",{className:"cp"},fmt(p.sellPrice))),
isOut&&h("div",{style:{fontSize:11,color:"#ef4444",fontWeight:700,marginTop:4}},"â›” ÐÐ•Ð¢"),isLow&&h("div",{style:{fontSize:11,color:"#f59e0b",fontWeight:700,marginTop:4}},"âš  ÐœÐ°Ð»Ð¾ â€” ",tot," ÑˆÑ‚."),
h("div",{style:{marginTop:6}},h(SzChips,{sizes:p.sizes,onChange:(sz,val)=>chgSz(p.id,sz,val)})),
h("div",{className:"crow",style:{marginTop:8}},h("span",{style:{fontSize:11,color:"var(--t3)",fontWeight:500}},"Ð¡ÐµÐ±ÐµÑÑ‚. ",fmt(p.costPrice)," Â· ",tot," ÑˆÑ‚."),h("button",{className:"btn bgh bxs",onClick:()=>del(p.id),style:{color:"#ef4444"}},I.del)))}))}

function OrdersPage({orders,setOrders,products,setProducts,clients,toast}){const[search,sSearch]=useState("");const[tab,sTab]=useState("active");const[view,sView]=useState(null);
const list=useMemo(()=>{let l=[...orders];if(tab==="active")l=l.filter(o=>["ÐÐ¾Ð²Ñ‹Ð¹","Ð¡Ð¾Ð±Ð¸Ñ€Ð°ÐµÑ‚ÑÑ","ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½"].includes(o.status));if(tab==="done")l=l.filter(o=>o.status==="Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½");if(tab==="other")l=l.filter(o=>["Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‚","ÐžÑ‚Ð¼ÐµÐ½Ñ‘Ð½"].includes(o.status));
if(search)l=l.filter(o=>o.clientName.toLowerCase().includes(search.toLowerCase())||(o.trackNumber||"").includes(search)||(o.clientCity||"").toLowerCase().includes(search.toLowerCase()));l.sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt));return l},[orders,search,tab]);
const nxtSt=o=>{const ns=NS[o.status];if(!ns)return;setOrders(prev=>prev.map(x=>x.id===o.id?{...x,status:ns,history:[...(x.history||[]),{status:ns,date:new Date().toISOString()}],updatedAt:new Date().toISOString()}:x));toast(`â†’ ${ns}`)};
const saveOrd=o=>{const old=orders.find(x=>x.id===o.id);if(old&&old.status!==o.status){o.history=[...(o.history||[]),{status:o.status,date:new Date().toISOString()}];if((o.status==="Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‚"||o.status==="ÐžÑ‚Ð¼ÐµÐ½Ñ‘Ð½")&&old.status!=="Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‚"&&old.status!=="ÐžÑ‚Ð¼ÐµÐ½Ñ‘Ð½"){setProducts(prev=>restoreStock(prev,o.items));toast("â†© ÐžÑÑ‚Ð°Ñ‚ÐºÐ¸")}}
o.total=calcTotal(o.items,products,o.discount);setOrders(prev=>prev.map(x=>x.id===o.id?o:x));sView(null);toast("âœ… Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¾")};
return h("div",null,h("div",{className:"h1"},"Ð—Ð°ÐºÐ°Ð·Ñ‹"),h("div",{className:"sub",style:{marginBottom:14}},orders.length," Ð²ÑÐµÐ³Ð¾"),
h("div",{className:"gsrch"},I.srch,h("input",{placeholder:"Ð˜Ð¼Ñ, Ð³Ð¾Ñ€Ð¾Ð´, Ñ‚Ñ€ÐµÐº...",value:search,onChange:e=>sSearch(e.target.value)})),
h("div",{className:"tabs"},[["active","ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ"],["all","Ð’ÑÐµ"],["done","Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ñ‹"],["other","Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‚"]].map(([k,l])=>h("div",{key:k,className:`tab ${tab===k?"on":""}`,onClick:()=>sTab(k)},l))),
list.length===0?h("div",{className:"empty"},"ÐÐµÑ‚ Ð·Ð°ÐºÐ°Ð·Ð¾Ð²"):list.map(o=>h("div",{key:o.id,className:"gc",onClick:()=>sView(o),style:{cursor:"pointer"}},
o.status==="ÐÐ¾Ð²Ñ‹Ð¹"&&daysAgo(o.createdAt)>=2&&h("div",{className:"stale-b"}),
h("div",{className:"crow"},h("div",{style:{display:"flex",alignItems:"center",gap:4}},h("span",{className:"cn"},o.clientName),o.urgent&&h("span",{className:"ud"}),o.status==="ÐÐ¾Ð²Ñ‹Ð¹"&&daysAgo(o.createdAt)>=2&&h("span",{style:{fontSize:9,color:"#ef4444",fontWeight:700,marginLeft:2}},daysAgo(o.createdAt),"Ð´")),h(StBadge,{status:o.status,onClick:e=>{e.stopPropagation();nxtSt(o)}})),
h(Stepper,{status:o.status}),
h("div",{style:{fontSize:12,color:"var(--t2)",fontWeight:500}},o.items.map((it,i)=>{const p=products.find(x=>x.id===it.productId);return h("span",{key:i},p?p.name:"?"," (",it.size,")",i<o.items.length-1?", ":"")})),
h("div",{className:"crow",style:{marginTop:4}},h("span",{style:{fontSize:11,color:"var(--t3)",fontWeight:500}},o.clientCity," Â· ",o.deliveryMethod,o.prepaid?" Â· âœ“":""),h("span",{className:"cp"},fmt(o.total||0))))),
view&&h(ViewOrdModal,{order:view,products,onSave:saveOrd,onClose:()=>sView(null),toast}))}

function ClientsPage({orders}){const[search,sSearch]=useState("");const map={};orders.forEach(o=>{const k=o.clientName.toLowerCase().trim();if(!map[k])map[k]={name:o.clientName,phone:"",city:"",orders:[],spent:0};map[k].orders.push(o);if(o.status==="Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½")map[k].spent+=o.total||0;if(o.clientPhone&&!map[k].phone)map[k].phone=o.clientPhone;if(o.clientCity&&!map[k].city)map[k].city=o.clientCity});
let list=Object.values(map).sort((a,b)=>b.spent-a.spent);if(search)list=list.filter(c=>c.name.toLowerCase().includes(search.toLowerCase()));
return h("div",null,h("div",{className:"h1"},"ÐšÐ»Ð¸ÐµÐ½Ñ‚Ñ‹"),h("div",{className:"sub",style:{marginBottom:14}},list.length," ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ñ…"),
h("div",{className:"gsrch"},I.srch,h("input",{placeholder:"Ð˜Ð¼Ñ...",value:search,onChange:e=>sSearch(e.target.value)})),
list.length===0?h("div",{className:"empty"},"ÐÐµÑ‚ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð²"):list.map((c,i)=>h("div",{key:i,className:"gc"},h("div",{className:"crow"},h("span",{className:"cn"},c.name),h("span",{className:"cp"},fmt(c.spent))),
h("div",{style:{fontSize:12,color:"var(--t2)",fontWeight:500,marginTop:2}},c.phone||"â€”"," Â· ",c.city||"â€”"),
h("div",{className:"crow",style:{marginTop:4}},h("span",{style:{fontSize:11,color:"var(--t3)",fontWeight:500}},c.orders.length," Ð·Ð°ÐºÐ°Ð·Ð¾Ð² Â· ",c.orders.filter(o=>o.status==="Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½").length," Ð´Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¾"),c.orders.length>=3&&h("span",{className:"badge-t"},I.star," ÐŸÐ¾ÑÑ‚Ð¾ÑÐ½Ð½Ñ‹Ð¹")))))}

function FinancePage({orders,products,toast}){const done=orders.filter(o=>o.status==="Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½");const rev=done.reduce((s,o)=>s+(o.total||0),0);const cost=done.reduce((s,o)=>s+o.items.reduce((is,it)=>{const p=products.find(x=>x.id===it.productId);return is+(p?p.costPrice*(+it.qty||1):0)},0),0);const profit=rev-cost;
const sm={};done.forEach(o=>o.items.forEach(it=>{if(!sm[it.productId])sm[it.productId]={qty:0,rev:0};const p=products.find(x=>x.id===it.productId);sm[it.productId].qty+=+it.qty||1;sm[it.productId].rev+=p?p.sellPrice*(+it.qty||1):0}));
const top=Object.entries(sm).map(([pid,d])=>({p:products.find(x=>x.id===pid),...d})).filter(x=>x.p).sort((a,b)=>b.rev-a.rev).slice(0,6);const mx=top.length?top[0].rev:1;
return h("div",null,h("div",{className:"crow"},h("div",{className:"h1"},"Ð¤Ð¸Ð½Ð°Ð½ÑÑ‹"),h("button",{className:"btn bg2 bxs",onClick:()=>exportCSV(orders,products)},I.dl," CSV")),h("div",{className:"sub",style:{marginBottom:14}},"ÐÐ½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ°"),
h("div",{className:"hscr"},h("div",{className:"gc"},h("div",{className:"stat-l"},"Ð’Ð«Ð Ð£Ð§ÐšÐ"),h("div",{className:"stat-v",style:{fontSize:18}},fmt(rev))),h("div",{className:"gc"},h("div",{className:"stat-l"},"Ð¡Ð•Ð‘Ð•Ð¡Ð¢ÐžÐ˜ÐœÐžÐ¡Ð¢Ð¬"),h("div",{className:"stat-v",style:{fontSize:18,color:"#ef4444"}},fmt(cost))),h("div",{className:"gc"},h("div",{className:"stat-l"},"ÐŸÐ Ð˜Ð‘Ð«Ð›Ð¬"),h("div",{className:"stat-v",style:{fontSize:18,color:profit>=0?"#10b981":"#ef4444"}},fmt(profit)),rev>0&&h("div",{className:"stat-s"},"ÐœÐ°Ñ€Ð¶Ð° ",Math.round(profit/rev*100),"%")),h("div",{className:"gc"},h("div",{className:"stat-l"},"Ð¡Ð . Ð§Ð•Ðš"),h("div",{className:"stat-v",style:{fontSize:18}},done.length?fmt(Math.round(rev/done.length)):"â€”"))),
top.length>0&&h(React.Fragment,null,h("div",{className:"h2",style:{marginBottom:8}},"ðŸ† Ð¢Ð¾Ð¿ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹"),top.map((t,i)=>h("div",{key:i,className:"gc"},h("div",{className:"crow"},h("div",{style:{display:"flex",alignItems:"center",gap:6}},h("span",{style:{fontSize:11,fontWeight:800,color:"var(--t3)",minWidth:16}},i+1),h("span",{className:"cn",style:{fontSize:13}},t.p.name),i===0&&h("span",{className:"badge-t"},I.star," Ð‘ÐµÑÑ‚ÑÐµÐ»Ð»ÐµÑ€")),h("span",{className:"cp",style:{fontSize:13}},fmt(t.rev))),h("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:6}},h("div",{className:"mbar",style:{flex:1}},h("div",{className:"mbar-f",style:{width:Math.round(t.rev/mx*100)+"%",background:`linear-gradient(90deg,${CC[t.p.category]||"var(--a)"},transparent)`}})),h("span",{style:{fontSize:10,color:"var(--t3)",fontWeight:600,whiteSpace:"nowrap"}},t.qty," ÑˆÑ‚."))))))}

function App(){const[pg,sPg]=useState("home");const[products,setProducts]=useP("products",[]);const[orders,setOrders]=useP("orders",[]);const{toasts,toast}=useToast();const[fo,sFo]=useState(false);const[modal,sMod]=useState(null);
const clients=useMemo(()=>{const m={};orders.forEach(o=>{const k=o.clientName.toLowerCase().trim();if(!m[k])m[k]={id:k,name:o.clientName,phone:o.clientPhone||"",city:o.clientCity||""};if(o.clientPhone&&!m[k].phone)m[k].phone=o.clientPhone;if(o.clientCity&&!m[k].city)m[k].city=o.clientCity});return Object.values(m)},[orders]);
const addP=p=>{setProducts(prev=>[...prev,p]);sMod(null);toast("âœ… Ð¢Ð¾Ð²Ð°Ñ€ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½")};
const addO=o=>{setProducts(prev=>deductStock(prev,o.items));setOrders(prev=>[...prev,o]);sMod(null);toast("âœ… Ð—Ð°ÐºÐ°Ð· ÑÐ¾Ð·Ð´Ð°Ð½")};
const newN=orders.filter(o=>o.status==="ÐÐ¾Ð²Ñ‹Ð¹").length;
const nav=[{id:"home",l:"Ð“Ð»Ð°Ð²Ð½Ð°Ñ",i:I.home},{id:"products",l:"Ð¢Ð¾Ð²Ð°Ñ€Ñ‹",i:I.tag},{id:"orders",l:"Ð—Ð°ÐºÐ°Ð·Ñ‹",i:I.box,dot:newN>0},{id:"clients",l:"ÐšÐ»Ð¸ÐµÐ½Ñ‚Ñ‹",i:I.usr},{id:"finance",l:"Ð¤Ð¸Ð½Ð°Ð½ÑÑ‹",i:I.dol}];
return h(React.Fragment,null,h("style",null,css),h("div",{className:"amb"}),
h("div",{className:"main"},pg==="home"&&h(HomePage,{products,orders}),pg==="products"&&h(ProductsPage,{products,setProducts,toast}),pg==="orders"&&h(OrdersPage,{orders,setOrders,products,setProducts,clients,toast}),pg==="clients"&&h(ClientsPage,{orders}),pg==="finance"&&h(FinancePage,{orders,products,toast})),
fo&&h("div",{className:"fov",onClick:()=>sFo(false)}),
fo&&h("div",{className:"fab-m"},h("div",null,h("div",{className:"fab-o",onClick:()=>{sFo(false);sMod("order")}},I.box," ÐÐ¾Ð²Ñ‹Ð¹ Ð·Ð°ÐºÐ°Ð·")),h("div",null,h("div",{className:"fab-o",onClick:()=>{sFo(false);sMod("product")}},I.tag," ÐÐ¾Ð²Ñ‹Ð¹ Ñ‚Ð¾Ð²Ð°Ñ€"))),
h("button",{className:"fab",onClick:()=>sFo(!fo),style:{transform:fo?"rotate(45deg)":"none"}},I.plus),
h("nav",{className:"bnav"},nav.map(n=>h("button",{key:n.id,className:`bn ${pg===n.id?"on":""}`,onClick:()=>sPg(n.id)},n.i,h("span",null,n.l),n.dot&&h("div",{className:"dot"})))),
modal==="product"&&h(AddProdModal,{onSave:addP,onClose:()=>sMod(null)}),
modal==="order"&&h(AddOrdModal,{products,clients,onSave:addO,onClose:()=>sMod(null),toast}),
h("div",{className:"tc"},toasts.map(t=>h("div",{key:t.id,className:`to ${t.type==="err"?"err":""}`},t.m))))}
ReactDOM.createRoot(document.getElementById("root")).render(h(App));
</script>
<script>if('serviceWorker' in navigator)window.addEventListener('load',()=>{navigator.serviceWorker.register('sw.js').catch(()=>{})})</script>
</body>
</html>
